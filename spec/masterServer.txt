The internal state of the master server is:

+ For each watcher that connected to it since it last started up, an (in theory) complete set of the file lists provided by that watcher, with id numbers and timestamps.

+ All (in theory) of the master file lists that have been produced so far.

The (in theory) bit is because there will be a garbage collector sort-of-thing that chops down the history.

The master server does these things:

+ Hands out the latest version of the main list when asked by the client.
+ Hands out guids of latest versions of watcher lists when asked by watchers.
+ Stores new watcher lists when handed in by watchers.
+ Creates and stores new watcher lists when diffs are handed in by watchers.
+ Updates the master list whenever a watcher list is updated.
